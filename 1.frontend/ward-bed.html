<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hospital Bed & Ward Management</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        :root {
            --font-main: 'Poppins', sans-serif;
        }

        body {
            font-family: var(--font-main);
            background-color: #f8f9fa; /* Bootstrap light gray */
        }

        /* --- Bed Card Styling --- */
        .bed-card {
            transition: transform 0.25s ease, box-shadow 0.25s ease;
            cursor: default;
            border: 0;
            border-left: 5px solid transparent; /* Status indicator strip */
        }

        .bed-card .card-body {
            padding: 1.25rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* Status: Available */
        .bed-available {
            background-color: #ffffff;
            border-left-color: #198754; /* Success Green */
        }
        .bed-available .icon-box {
            color: #198754;
            background-color: #e8f5e9;
        }
        .bed-available:hover {
            cursor: pointer;
            transform: translateY(-5px);
            box-shadow: 0 .5rem 1rem rgba(0,0,0,.15)!important;
            border-color: #198754; /* Full border highlight on hover */
        }

        /* Status: Occupied */
        .bed-occupied {
            background-color: #fff5f5;
            border-left-color: #dc3545; /* Danger Red */
        }
        .bed-occupied .icon-box {
            color: #dc3545;
            background-color: #ffebee;
        }

        /* Status: Cleaning */
        .bed-cleaning {
            background-color: #fffbf0;
            border-left-color: #ffc107; /* Warning Yellow */
        }
        .bed-cleaning .icon-box {
            color: #ffc107;
            background-color: #fff8e1;
        }

        /* Icon Container */
        .icon-box {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            transition: all 0.3s;
        }
    </style>
</head>
<body>

    <nav class="navbar navbar-expand-lg navbar-white bg-white shadow-sm sticky-top mb-4">
        <div class="container-fluid px-lg-5">
            <a class="navbar-brand fw-bold d-flex align-items-center text-primary" href="#">
                <i class="fas fa-hospital-user me-2 fs-3"></i>
                <span>Ward & Bed<span class="text-dark">Manager</span></span>
            </a>
            
            <div class="d-flex align-items-center gap-3 ms-auto">
                <div class="d-flex align-items-center">
                    <span class="badge rounded-pill bg-success me-1">&bull;</span>
                    <small class="fw-medium text-secondary">Available</small>
                </div>
                <div class="d-flex align-items-center">
                    <span class="badge rounded-pill bg-danger me-1">&bull;</span>
                    <small class="fw-medium text-secondary">Occupied</small>
                </div>
                <div class="d-flex align-items-center">
                    <span class="badge rounded-pill bg-warning text-dark me-1">&bull;</span>
                    <small class="fw-medium text-secondary">Cleaning</small>
                </div>
            </div>
        </div>
    </nav>

    <div class="container-fluid px-lg-5 pb-5">
        <div id="ward-container" class="vstack gap-4">
            </div>
    </div>

    <div class="modal fade" id="allocationModal" tabindex="-1" aria-labelledby="allocationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg rounded-4">
                <div class="modal-header bg-light border-0">
                    <div>
                        <h5 class="modal-title fw-bold text-primary" id="allocationModalLabel">Allocate Bed</h5>
                        <small class="text-muted" id="modal-bed-info">Ward Info</small>
                    </div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-4">
                    <form id="allocation-form">
                        <input type="hidden" id="bed-id-input">
                        
                        <div class="form-floating mb-3">
                            <input type="text" class="form-control rounded-3" id="patient-name" placeholder="John Doe" required>
                            <label for="patient-name">Patient Name</label>
                        </div>

                        <div class="form-floating mb-3">
                            <input type="text" class="form-control rounded-3" id="patient-id" placeholder="P-1234" required>
                            <label for="patient-id">Patient ID / MRN</label>
                        </div>

                        <div class="form-floating mb-3">
                            <input type="date" class="form-control rounded-3" id="admission-date" required>
                            <label for="admission-date">Admission Date</label>
                        </div>

                        <div class="d-grid pt-2">
                            <button type="submit" class="btn btn-primary btn-lg rounded-pill shadow-sm">
                                Confirm Allocation
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <div id="liveToast" class="toast align-items-center text-bg-success border-0 shadow-lg" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="d-flex">
                <div class="toast-body fs-6">
                    <i class="fas fa-check-circle me-2"></i> <span id="toast-message">Action Successful</span>
                </div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Bootstrap Components ---
            const allocationModal = new bootstrap.Modal(document.getElementById('allocationModal'));
            const liveToast = new bootstrap.Toast(document.getElementById('liveToast'));
            
            // --- Data Store ---
            let wards = [
                {
                    id: 'ward-gen',
                    name: 'General Ward',
                    beds: [
                        { id: 'gen-01', status: 'occupied', patient: { name: 'Ravi Kumar', id: 'P0123' } },
                        { id: 'gen-02', status: 'available' },
                        { id: 'gen-03', status: 'cleaning' },
                        { id: 'gen-04', status: 'available' },
                        { id: 'gen-05', status: 'occupied', patient: { name: 'Priya Sharma', id: 'P0456' } },
                        { id: 'gen-06', status: 'available' },
                        { id: 'gen-07', status: 'available' },
                        { id: 'gen-08', status: 'occupied', patient: { name: 'Amit Singh', id: 'P0512' } },
                    ]
                },
                {
                    id: 'ward-icu',
                    name: 'Intensive Care Unit (ICU)',
                    beds: [
                        { id: 'icu-01', status: 'occupied', patient: { name: 'Anil Verma', id: 'P0789' } },
                        { id: 'icu-02', status: 'occupied', patient: { name: 'Sunita Devi', id: 'P1011' } },
                        { id: 'icu-03', status: 'cleaning' },
                        { id: 'icu-04', status: 'available' },
                    ]
                },
                {
                    id: 'ward-mat',
                    name: 'Maternity Ward',
                    beds: [
                        { id: 'mat-01', status: 'available' },
                        { id: 'mat-02', status: 'occupied', patient: { name: 'Geeta Singh', id: 'P1213' } },
                        { id: 'mat-03', status: 'available' },
                        { id: 'mat-04', status: 'available' },
                    ]
                }
            ];

            const wardContainer = document.getElementById('ward-container');
            const allocationForm = document.getElementById('allocation-form');
            const bedIdInput = document.getElementById('bed-id-input');
            const modalBedInfo = document.getElementById('modal-bed-info');
            const admissionDateInput = document.getElementById('admission-date');

            // --- Render Logic ---
            function renderWards() {
                wardContainer.innerHTML = '';
                
                wards.forEach(ward => {
                    // Create Ward Card
                    const wardCard = document.createElement('div');
                    wardCard.className = 'card border-0 shadow-sm rounded-4 overflow-hidden';
                    
                    // Ward Header
                    const header = document.createElement('div');
                    header.className = 'card-header bg-white border-bottom pt-4 px-4 pb-0 d-flex justify-content-between align-items-center';
                    header.innerHTML = `<h5 class="fw-bold text-dark mb-3">${ward.name}</h5>`;
                    
                    // Grid Body
                    const body = document.createElement('div');
                    body.className = 'card-body p-4 bg-light';
                    
                    const row = document.createElement('div');
                    row.className = 'row g-3'; // Bootstrap Grid Gap

                    ward.beds.forEach(bed => {
                        const col = document.createElement('div');
                        col.className = 'col-6 col-md-4 col-lg-3 col-xl-2'; // Responsive Columns
                        col.appendChild(createBedElement(bed, ward));
                        row.appendChild(col);
                    });

                    body.appendChild(row);
                    wardCard.appendChild(header);
                    wardCard.appendChild(body);
                    wardContainer.appendChild(wardCard);
                });
            }

            function createBedElement(bed, ward) {
                const bedCard = document.createElement('div');
                bedCard.dataset.bedId = bed.id;
                bedCard.dataset.wardId = ward.id;
                
                // Determine styling based on status
                let statusClass = '';
                let iconClass = '';
                let titleText = '';
                let subText = '';

                switch(bed.status) {
                    case 'available':
                        statusClass = 'bed-available shadow-sm';
                        iconClass = 'fa-bed';
                        titleText = 'Available';
                        subText = 'Click to Book';
                        break;
                    case 'occupied':
                        statusClass = 'bed-occupied';
                        iconClass = 'fa-user-injured';
                        titleText = bed.patient.name;
                        subText = `<span class="badge bg-danger-subtle text-danger border border-danger-subtle">Occupied</span>`;
                        break;
                    case 'cleaning':
                        statusClass = 'bed-cleaning';
                        iconClass = 'fa-pump-soap';
                        titleText = 'Cleaning';
                        subText = `<span class="badge bg-warning-subtle text-warning-emphasis border border-warning-subtle">Wait</span>`;
                        break;
                }

                bedCard.className = `card h-100 bed-card ${statusClass}`;
                bedCard.innerHTML = `
                    <div class="card-body">
                        <div class="icon-box">
                            <i class="fas ${iconClass}"></i>
                        </div>
                        <h6 class="fw-bold mb-1 text-center text-truncate w-100">${titleText}</h6>
                        <div class="small text-muted mb-2">Bed ${bed.id.split('-')[1]}</div>
                        <div class="mt-auto">${subText}</div>
                    </div>
                `;

                return bedCard;
            }

            // --- Interaction Logic ---
            
            // Open Modal
            wardContainer.addEventListener('click', (e) => {
                const bedCard = e.target.closest('.bed-available');
                if (bedCard) {
                    const { bedId, wardId } = bedCard.dataset;
                    const ward = wards.find(w => w.id === wardId);
                    const bedNumber = bedId.split('-')[1];

                    bedIdInput.value = bedId;
                    modalBedInfo.textContent = `${ward.name} â€¢ Bed No. ${bedNumber}`;
                    admissionDateInput.valueAsDate = new Date();
                    
                    allocationModal.show();
                }
            });

            // Handle Form Submit
            allocationForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const bedId = bedIdInput.value;
                const patientName = document.getElementById('patient-name').value;
                const patientId = document.getElementById('patient-id').value;

                // Update Logic
                wards.forEach(ward => {
                    const bed = ward.beds.find(b => b.id === bedId);
                    if (bed) {
                        bed.status = 'occupied';
                        bed.patient = { name: patientName, id: patientId };
                    }
                });

                // Reset & Render
                allocationForm.reset();
                allocationModal.hide();
                renderWards();

                // Show Toast
                document.getElementById('toast-message').textContent = `Bed allocated to ${patientName}`;
                liveToast.show();
            });

            // Initial Render
            renderWards();
        });
    </script>
</body>
</html>